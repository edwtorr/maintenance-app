---
import MainLayout from '@/layouts/MainLayout.astro';
import Button from '@/components/Button';
import Badge from '@/components/Badge';
import Select from '@/components/Select';
import { Plus, Upload, FileText, Download, Eye, Trash2 } from 'lucide-react';

const manualTypes = [
  { value: 'all', label: 'Todos los tipos' },
  { value: 'maintenance', label: 'Mantenimiento' },
  { value: 'operation', label: 'Operación' },
  { value: 'troubleshooting', label: 'Solución de Problemas' },
  { value: 'safety', label: 'Seguridad' },
];

const lines = [
  { value: 'all', label: 'Todas las líneas' },
  { value: 'L16', label: 'L16' },
  { value: 'L20', label: 'L20' },
  { value: 'L33', label: 'L33' },
];

const manuals = [
  {
    id: 1,
    title: 'Manual de Mantenimiento - Motor Principal',
    type: 'maintenance',
    machine: 'Máquina XZ-100',
    line: 'L16',
    version: 'v2.3',
    date: '2024-10-15',
    size: '2.4 MB',
    format: 'PDF',
  },
  {
    id: 2,
    title: 'Guía de Operación - Sistema Hidráulico',
    type: 'operation',
    machine: 'Máquina AB-250',
    line: 'L20',
    version: 'v1.5',
    date: '2024-09-20',
    size: '1.8 MB',
    format: 'PDF',
  },
  {
    id: 3,
    title: 'Troubleshooting - Sensores de Temperatura',
    type: 'troubleshooting',
    machine: 'Máquina CD-320',
    line: 'L33',
    version: 'v3.0',
    date: '2024-11-01',
    size: '3.2 MB',
    format: 'PDF',
  },
  {
    id: 4,
    title: 'Manual de Seguridad - Protocolos de Emergencia',
    type: 'safety',
    machine: 'General',
    line: 'Todas',
    version: 'v4.1',
    date: '2024-08-10',
    size: '5.6 MB',
    format: 'PDF',
  },
];

const typeColorMap: Record<string, any> = {
  maintenance: 'primary',
  operation: 'info',
  troubleshooting: 'warning',
  safety: 'danger',
};

const typeLabels: Record<string, string> = {
  maintenance: 'Mantenimiento',
  operation: 'Operación',
  troubleshooting: 'Problemas',
  safety: 'Seguridad',
};
---

<MainLayout title="Manuales Técnicos - Gestión de Averías" currentPath="/manuals">
  <div class="mb-6">
    <div class="flex items-center justify-between mb-4">
      <div>
        <h1 class="text-3xl font-bold text-dark-900 dark:text-dark-50 mb-2">
          Manuales Técnicos
        </h1>
        <p class="text-dark-600 dark:text-dark-400">
          Biblioteca de documentación técnica y manuales
        </p>
      </div>
      <Button variant="primary" icon={<Upload class="w-4 h-4" />} client:load>
        Subir Manual
      </Button>
    </div>
  </div>

  <!-- Filters -->
  <div class="card p-4 mb-6">
    <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
      <Select
        label="Tipo de Manual"
        options={manualTypes}
        client:load
      />
      <Select
        label="Línea de Producción"
        options={lines}
        client:load
      />
      <div>
        <label class="block text-sm font-medium text-dark-900 dark:text-dark-50 mb-1.5">
          Búsqueda
        </label>
        <input
          type="search"
          placeholder="Buscar manuales..."
          class="w-full px-4 py-2 rounded-lg bg-white dark:bg-dark-900 border border-light-300 dark:border-dark-700 text-dark-900 dark:text-dark-50 focus:outline-none focus:ring-2 focus:ring-primary-500"
        />
      </div>
    </div>
  </div>

  <!-- Manuals Grid -->
  <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
    {manuals.map((manual) => (
      <div class="card p-6 hover:shadow-medium transition-shadow">
        <div class="flex items-start justify-between mb-4">
          <div class="p-3 bg-primary-50 dark:bg-primary-900/20 rounded-lg">
            <FileText class="w-6 h-6 text-primary-600 dark:text-primary-400" />
          </div>
          <Badge variant={typeColorMap[manual.type]} client:load>
            {typeLabels[manual.type]}
          </Badge>
        </div>

        <h3 class="font-semibold text-dark-900 dark:text-dark-50 mb-2 line-clamp-2">
          {manual.title}
        </h3>

        <div class="space-y-2 mb-4 text-sm text-dark-600 dark:text-dark-400">
          <div class="flex justify-between">
            <span>Máquina:</span>
            <span class="font-medium">{manual.machine}</span>
          </div>
          <div class="flex justify-between">
            <span>Línea:</span>
            <span class="font-medium">{manual.line}</span>
          </div>
          <div class="flex justify-between">
            <span>Versión:</span>
            <span class="font-medium">{manual.version}</span>
          </div>
          <div class="flex justify-between">
            <span>Tamaño:</span>
            <span class="font-medium">{manual.size}</span>
          </div>
          <div class="flex justify-between">
            <span>Actualizado:</span>
            <span class="font-medium">{manual.date}</span>
          </div>
        </div>

        <div class="flex gap-2 pt-4 border-t border-light-300 dark:border-dark-800">
          <Button
            variant="primary"
            size="sm"
            fullWidth
            icon={<Eye class="w-4 h-4" />}
            client:load
          >
            Ver
          </Button>
          <Button
            variant="outline"
            size="sm"
            icon={<Download class="w-4 h-4" />}
            client:load
          />
          <Button
            variant="outline"
            size="sm"
            icon={<Trash2 class="w-4 h-4" />}
            client:load
          />
        </div>
      </div>
    ))}
  </div>

  <!-- Upload Modal Placeholder -->
  <div id="upload-modal" class="hidden">
    <!-- Modal will be implemented with React component -->
  </div>
</MainLayout>
